<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Procedural Art Generator Pro</title>
  <link rel="stylesheet" href="global.css">
  <style>
    .tabs { display: flex; gap: 1rem; margin-bottom: 1rem; }
    .tab { padding: 0.5rem 1rem; background: #ddd; cursor: pointer; border-radius: 0.5rem; }
    .tab.active { background: #bbb; }
    .controls { margin-bottom: 1rem; }
    .hidden { display: none; }
    canvas { border: 2px solid #111; margin: 1rem 0; background: #1a1a1a; }
    .checkbox-group { display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem; }
  </style>
</head>
<body>
<div id="header-placeholder"></div>
<main style="flex-direction: column; align-items: center;">
  <div class="tabs">
    <div class="tab active" data-mode="free">Free Choice</div>
    <div class="tab" data-mode="tonal">Tonal</div>
    <div class="tab" data-mode="complementary">Complementary</div>
  </div>  <div id="free" class="controls">
    <input type="color" multiple id="free-colors" /> (Select multiple colours manually)
  </div>  <div id="tonal" class="controls hidden">
    <input type="color" id="tonal-base" /> (Select base colour)
  </div>  <div id="complementary" class="controls hidden">
    <input type="color" id="complementary-base" /> (Select base colour)
  </div>  <div class="controls">
    <label>Background Colour: <input type="color" id="background-color" value="#1a1a1a"></label>
  </div>  <div class="checkbox-group">
    <label><input type="checkbox" id="circles" checked> Circles</label>
    <label><input type="checkbox" id="lines" checked> Straight Lines</label>
    <label><input type="checkbox" id="wavy-lines" checked> Wavy Lines</label>
    <label><input type="checkbox" id="wavy-polygons" checked> Wavy Polygons</label>
  </div>  <div class="controls">
    <label>Complexity (number of shapes): <input type="range" id="complexity" min="100" max="1000" value="500"></label>
  </div><button id="generate">Generate</button> <button id="save">Save as PNG</button>

<canvas id="artCanvas" width="600" height="600"></canvas>

</main><script>
fetch('header.html')
  .then(response => response.text())
  .then(data => { document.getElementById('header-placeholder').innerHTML = data; });

const tabs = document.querySelectorAll('.tab');
const sections = ['free', 'tonal', 'complementary'];
let currentMode = 'free';

const canvas = document.getElementById('artCanvas');
const ctx = canvas.getContext('2d');

const generateBtn = document.getElementById('generate');
const saveBtn = document.getElementById('save');

function pickColors() {
  if (currentMode === 'free') {
    return [document.getElementById('free-colors').value];
  } else {
    let base = document.getElementById(currentMode + '-base').value;
    return generatePalette(base, currentMode);
  }
}

function generatePalette(baseColor, mode) {
  const base = hexToHSL(baseColor);
  let palette = [];
  if (mode === 'tonal') {
    for (let i = -30; i <= 30; i += 12) {
      palette.push(`hsl(${(base.h + i + 360) % 360}, ${base.s}%, ${base.l}%)`);
    }
  } else if (mode === 'complementary') {
    const compHue = (base.h + 180) % 360;
    for (let i = -30; i <= 30; i += 12) {
      palette.push(`hsl(${(compHue + i + 360) % 360}, ${base.s}%, ${base.l}%)`);
    }
  }
  return palette;
}

function hexToHSL(hex) {
  let r = 0, g = 0, b = 0;
  if (hex.length == 7) {
    r = parseInt(hex.substring(1,3), 16) / 255;
    g = parseInt(hex.substring(3,5), 16) / 255;
    b = parseInt(hex.substring(5,7), 16) / 255;
  }
  let cmin = Math.min(r,g,b), cmax = Math.max(r,g,b), delta = cmax - cmin;
  let h = 0, s = 0, l = 0;
  if (delta == 0) h = 0;
  else if (cmax == r) h = ((g - b) / delta) % 6;
  else if (cmax == g) h = (b - r) / delta + 2;
  else h = (r - g) / delta + 4;
  h = Math.round(h * 60);
  if (h < 0) h += 360;
  l = (cmax + cmin) / 2;
  s = delta == 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));
  s = +(s * 100).toFixed(1);
  l = +(l * 100).toFixed(1);
  return {h,s,l};
}

function drawArt() {
  const colors = pickColors();
  const complexity = document.getElementById('complexity').value;
  const background = document.getElementById('background-color').value;

  const shapes = [];
  if (document.getElementById('circles').checked) shapes.push('circle');
  if (document.getElementById('lines').checked) shapes.push('line');
  if (document.getElementById('wavy-lines').checked) shapes.push('wavy-line');
  if (document.getElementById('wavy-polygons').checked) shapes.push('wavy-polygon');

  ctx.fillStyle = background;
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  for (let i = 0; i < complexity; i++) {
    const shape = shapes[Math.floor(Math.random() * shapes.length)];
    ctx.fillStyle = ctx.strokeStyle = colors[Math.floor(Math.random() * colors.length)];
    if (shape === 'circle') drawCircle();
    else if (shape === 'line') drawLine();
    else if (shape === 'wavy-line') drawWavyLine();
    else if (shape === 'wavy-polygon') drawWavyPolygon();
  }
}

function drawCircle() {
  ctx.beginPath();
  const x = Math.random() * canvas.width;
  const y = Math.random() * canvas.height;
  const radius = Math.random() * 30;
  ctx.arc(x, y, radius, 0, Math.PI * 2);
  ctx.fill();
  ctx.closePath();
}

function drawLine() {
  ctx.beginPath();
  ctx.moveTo(Math.random() * canvas.width, Math.random() * canvas.height);
  ctx.lineTo(Math.random() * canvas.width, Math.random() * canvas.height);
  ctx.lineWidth = Math.random() * 3;
  ctx.stroke();
  ctx.closePath();
}

function drawWavyLine() {
  ctx.beginPath();
  let x = Math.random() * canvas.width;
  let y = Math.random() * canvas.height;
  ctx.moveTo(x, y);
  for (let i = 0; i < 5; i++) {
    x += Math.random() * 100 - 50;
    y += Math.random() * 100 - 50;
    ctx.lineTo(x, y);
  }
  ctx.lineWidth = Math.random() * 2;
  ctx.stroke();
  ctx.closePath();
}

function drawWavyPolygon() {
  ctx.beginPath();
  const sides = Math.floor(Math.random() * 4) + 5;
  const centerX = Math.random() * canvas.width;
  const centerY = Math.random() * canvas.height;
  const radius = Math.random() * 50 + 20;
  for (let i = 0; i <= sides; i++) {
    const angle = (i / sides) * Math.PI * 2;
    const r = radius + Math.random() * 10 - 5;
    const x = centerX + Math.cos(angle) * r;
    const y = centerY + Math.sin(angle) * r;
    if (i === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  }
  ctx.closePath();
  ctx.fill();
}

// Tab switching
tabs.forEach(tab => {
  tab.addEventListener('click', () => {
    tabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    currentMode = tab.dataset.mode;
    sections.forEach(section => {
      document.getElementById(section).classList.add('hidden');
    });
    document.getElementById(currentMode).classList.remove('hidden');
  });
});

generateBtn.addEventListener('click', drawArt);

saveBtn.addEventListener('click', () => {
  const link = document.createElement('a');
  link.download = 'artwork.png';
  link.href = canvas.toDataURL();
  link.click();
});
</script></body>
</html>